generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum AccountCategory {
  ASSET
  HUTANG
  MODAL
  PENDAPATAN
  BIAYA
}

enum AccountType {
  GENERAL
  DETAIL
}

enum LedgerType {
  KAS_MASUK
  KAS_KELUAR
}

enum PostingStatus {
  PENDING
  POSTED
}

enum ReportType {
  NERACA
  LABA_RUGI
}

enum Role {
  NASABAH
  KASIR
  KOLEKTOR
  MANAJER
  ADMIN
  AKUNTAN
}

enum TransactionType {
  DEBIT
  CREDIT
}

enum UserStatus {
  ACTIVE
  INACTIVE
}

model User {
  id          String     @id
  username    String     @unique
  password    String
  name        String
  role        Role       @default(NASABAH)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime
  status      UserStatus @default(ACTIVE)
  createdBy   String
  forceLogout Boolean    @default(false)

  @@map("users")
}

model AccountDetail {
  id                          String          @id
  accountNumber               String          @unique
  accountName                 String
  accountType                 AccountType     @default(DETAIL)
  createdAt                   DateTime        @default(now())
  updatedAt                   DateTime
  createdBy                   String
  updatedBy                   String
  accountGeneralAccountNumber String
  accountCategory             AccountCategory
  initialAmountCredit         Decimal         @default(0) @db.Decimal(10, 2)
  initialAmountDebit          Decimal         @default(0) @db.Decimal(10, 2)
  accumulationAmountCredit    Decimal         @default(0) @db.Decimal(10, 2)
  accumulationAmountDebit     Decimal         @default(0) @db.Decimal(10, 2)
  amountCredit                Decimal         @default(0) @db.Decimal(10, 2)
  amountDebit                 Decimal         @default(0) @db.Decimal(10, 2)
  deletedAt                   DateTime?
  reportType                  ReportType
  transactionType             TransactionType
  accountGeneral              AccountGeneral  @relation(fields: [accountGeneralAccountNumber], references: [accountNumber])
  ledgers                     Ledger[]

  @@map("accounts_detail")
}

model AccountGeneral {
  id                       String          @id
  accountNumber            String          @unique
  accountName              String
  accountType              AccountType     @default(GENERAL)
  createdAt                DateTime        @default(now())
  updatedAt                DateTime
  createdBy                String
  updatedBy                String
  accountCategory          AccountCategory
  initialAmountCredit      Decimal         @default(0) @db.Decimal(10, 2)
  initialAmountDebit       Decimal         @default(0) @db.Decimal(10, 2)
  accumulationAmountCredit Decimal         @default(0) @db.Decimal(10, 2)
  accumulationAmountDebit  Decimal         @default(0) @db.Decimal(10, 2)
  amountCredit             Decimal         @default(0) @db.Decimal(10, 2)
  amountDebit              Decimal         @default(0) @db.Decimal(10, 2)
  deletedAt                DateTime?
  reportType               ReportType
  transactionType          TransactionType
  accountsDetail           AccountDetail[]
  ledgers                  Ledger[]

  @@map("accounts_general")
}

model Balances {
  id        String   @id
  amount    Decimal  @db.Decimal(10, 2)
  createdAt DateTime @default(now())
  updatedAt DateTime
  createdBy String
  updatedBy String

  @@map("balances")
}

model Ledger {
  id                          String          @id
  referenceNumber             String
  amount                      Decimal         @db.Decimal(10, 2)
  description                 String
  createdAt                   DateTime        @default(now())
  updatedAt                   DateTime
  createdBy                   String
  updatedBy                   String
  accountDetailAccountNumber  String
  ledgerType                  LedgerType
  transactionType             TransactionType
  postingStatus               PostingStatus   @default(PENDING)
  postingAt                   DateTime?
  accountGeneralAccountNumber String
  deletedAt                   DateTime?
  ledgerDate                  DateTime
  accountDetail               AccountDetail   @relation(fields: [accountDetailAccountNumber], references: [accountNumber])
  accountGeneral              AccountGeneral  @relation(fields: [accountGeneralAccountNumber], references: [accountNumber])

  @@map("ledgers")
}

model JournalLedger {
  id                          String          @id
  referenceNumber             String
  accountDetailAccountNumber  String
  accountGeneralAccountNumber String
  transactionType             TransactionType
  amount                      Decimal         @default(0) @db.Decimal(10, 2)
  reportType                  ReportType
  ledgerDate                  DateTime
  postingStatus               PostingStatus   @default(PENDING)
  postingAt                   DateTime?
  createdAt                   DateTime        @default(now())
  createdBy                   String

  @@map("journal_ledgers")
}

model JournalBalance {
  id                          String          @id
  accountDetailAccountNumber  String
  accountGeneralAccountNumber String
  transactionType             TransactionType
  amountCredit                Decimal         @default(0) @db.Decimal(10, 2)
  amountDebit                 Decimal         @default(0) @db.Decimal(10, 2)
  reportType                  ReportType
  createdAt                   DateTime        @default(now())
  createdBy                   String

  @@map("journal_balances")
}

model SisaHasilUsaha {
  id        String   @id
  year      String
  amount    Decimal  @db.Decimal(10, 2)
  createdAt DateTime @default(now())
  updatedAt DateTime

  @@map("sisa_hasil_usaha")
}
